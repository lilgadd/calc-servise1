# üìä –ü—Ä–æ–µ–∫—Ç: –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä HTTP API

#### –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä, —Ä–∞–±–æ—Ç–∞—é—â–∏–π —á–µ—Ä–µ–∑ HTTP-—Å–µ—Ä–≤–∏—Å! –≠—Ç–æ—Ç —Å–µ—Ä–≤–µ—Ä –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –≤ –≤–∏–¥–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

---

#### –°–µ—Ä–≤–∏—Å –ø—Ä–∏–Ω–∏–º–∞–µ—Ç POST-–∑–∞–ø—Ä–æ—Å—ã —Å –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–∏–º–∏ –≤—ã—Ä–∞–∂–µ–Ω–∏—è–º–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON, –≤—ã—á–∏—Å–ª—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –µ–≥–æ –≤ –≤–∏–¥–µ –æ—Ç–≤–µ—Ç–∞. –°–µ—Ä–≤–∏—Å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏:
* ##### –°–ª–æ–∂–µ–Ω–∏–µ (+)
* ##### –í—ã—á–∏—Ç–∞–Ω–∏–µ (-)
* ##### –£–º–Ω–æ–∂–µ–Ω–∏–µ (*)
* ##### –î–µ–ª–µ–Ω–∏–µ (/)
###### –¢–∞–∫–∂–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –≤—ã—Ä–∞–∂–µ–Ω–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–∫–æ–±–æ–∫, –Ω–∞–ø—Ä–∏–º–µ—Ä:

(2 + 3) * 4


### üöÄ –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞

1. ##### –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Go (–≤–µ—Ä—Å–∏–∏ 1.18 –∏–ª–∏ –Ω–æ–≤–µ–µ).  
2. ##### –°–∫–ª–æ–Ω–∏—Ä—É–π—Ç–µ –ø—Ä–æ–µ–∫—Ç:  
    
git clone https://github.com/lilgadd/calc.go

3. ##### –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –∫–æ—Ä–Ω–µ–≤—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞:
    
cd calc-service

4. ##### –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä:
    
go run cmd/orchestrator/main.go

    
go run cmd/agent/main.go

    ###### –ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É:
    
http://localhost:8080


---

### üåê Endpoint API

1. **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤—ã—Ä–∞–∂–µ–Ω–∏—è**
    - **URL**: /api/v1/calculate
    - **–ú–µ—Ç–æ–¥**: POST
    - **–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞**:

    
json
    {
      "expression": "<—Å—Ç—Ä–æ–∫–∞ —Å –≤—ã—Ä–∞–∂–µ–Ω–∏–µ–º>"
    }


    - **–û—Ç–≤–µ—Ç**:

    
json
    {
      "id": "<—É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –≤—ã—Ä–∞–∂–µ–Ω–∏—è>"
    }


    - **–ö–æ–¥—ã –æ—Ç–≤–µ—Ç–∞**:
        - 201 ‚Äî –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–∏–Ω—è—Ç–æ –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è
        - 422 ‚Äî –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
        - 500 ‚Äî –æ—à–∏–±–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

    - **–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞**:
    
    –£—Å–ø–µ—à–Ω—ã–π –∑–∞–ø—Ä–æ—Å:
    
curl -X POST http://localhost:8080/api/v1/calculate \
    -H "Content-Type: application/json" \
    -d '{"expression": "2 * (3 + 4)"}'


    –û—Ç–≤–µ—Ç:
    
json
    {
      "id": "123456"
    }


    –û—à–∏–±–∫–∞ 422:
    
curl -X POST http://localhost:8080/api/v1/calculate \
    -H "Content-Type: application/json" \
    -d '{"expression": "3 + a * 5"}'


    –û—Ç–≤–µ—Ç:
    
json
    {
      "error": "Expression is not valid"
    }


    –û—à–∏–±–∫–∞ 500:
    
curl -X POST http://localhost:8080/api/v1/calculate \
    -H "Content-Type: application/json" \
    -d '{"expression": "5 / 0"}'


    –û—Ç–≤–µ—Ç:
    
json
    {
      "error": "Division by zero is not allowed"
    }


2. **–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –≤—ã—Ä–∞–∂–µ–Ω–∏–π**
    - **URL**: /api/v1/expressions
    - **–ú–µ—Ç–æ–¥**: GET
    - **–û—Ç–≤–µ—Ç**:

    
json
    {
      "expressions": [
        {
          "id": "<–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –≤—ã—Ä–∞–∂–µ–Ω–∏—è>",
          "status": "<—Å—Ç–∞—Ç—É—Å –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –≤—ã—Ä–∞–∂–µ–Ω–∏—è>",
          "result": "<—Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã—Ä–∞–∂–µ–Ω–∏—è>"
        },
      ]
    }


    - **–ö–æ–¥—ã –æ—Ç–≤–µ—Ç–∞**:
        - 200 ‚Äî —É—Å–ø–µ—à–Ω–æ –ø–æ–ª—É—á–µ–Ω —Å–ø–∏—Å–æ–∫ –≤—ã—Ä–∞–∂–µ–Ω–∏–π
        - 500 ‚Äî –æ—à–∏–±–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

3. **–ü–æ–ª—É—á–µ–Ω–∏–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –ø–æ –µ–≥–æ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—É**
    - **URL**: /api/v1/expressions/{id}
    - **–ú–µ—Ç–æ–¥**: GET
    - **–û—Ç–≤–µ—Ç**:

    
json
    {
      "expression": {
        "id": "<–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –≤—ã—Ä–∞–∂–µ–Ω–∏—è>",
        "status": "<—Å—Ç–∞—Ç—É—Å –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –≤—ã—Ä–∞–∂–µ–Ω–∏—è>",
        "result": "<—Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã—Ä–∞–∂–µ–Ω–∏—è>"
      }
    }


    - **–ö–æ–¥—ã –æ—Ç–≤–µ—Ç–∞**:
        - 200 ‚Äî —É—Å–ø–µ—à–Ω–æ –ø–æ–ª—É—á–µ–Ω–æ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ
        - 404 ‚Äî –Ω–µ—Ç —Ç–∞–∫–æ–≥–æ –≤—ã—Ä–∞–∂–µ–Ω–∏—è
        - 500 ‚Äî –æ—à–∏–±–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

4. **–ü–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è**
    - **URL**: /internal/task
    - **–ú–µ—Ç–æ–¥**: GET
    - **–û—Ç–≤–µ—Ç**:

    
json
    {
      "task": {
        "id": "<–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∑–∞–¥–∞—á–∏>",
        "arg1": "<–∏–º—è –ø–µ—Ä–≤–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞>",
        "arg2": "<–∏–º—è –≤—Ç–æ—Ä–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞>",
        "operation": "<–æ–ø–µ—Ä–∞—Ü–∏—è>",
        "operation_time": "<–≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–∏>"
      }
    }


    - **–ö–æ–¥—ã –æ—Ç–≤–µ—Ç–∞**:
        - 200 ‚Äî —É—Å–ø–µ—à–Ω–æ –ø–æ–ª—É—á–µ–Ω–∞ –∑–∞–¥–∞—á–∞
        - 404 ‚Äî –Ω–µ—Ç –∑–∞–¥–∞—á–∏
        - 500 ‚Äî –æ—à–∏–±–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

5. **–ü—Ä–∏–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö**
    - **URL**: /internal/task
    - **–ú–µ—Ç–æ–¥**: POST
    - **–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞**:

    
json
    {
      "id": 1,
      "result": 2.5
    }


    - **–ö–æ–¥—ã –æ—Ç–≤–µ—Ç–∞**:
        - 200 ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç —É—Å–ø–µ—à–Ω–æ –∑–∞–ø–∏—Å–∞–Ω
        - 404 ‚Äî –Ω–µ—Ç —Ç–∞–∫–æ–π –∑–∞–¥–∞—á–∏
        - 422 ‚Äî –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
        - 500 ‚Äî –æ—à–∏–±–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

---

### üîé –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

–î–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–ª–µ–¥—É—é—â—É—é –∫–æ–º–∞–Ω–¥—É:
go test ./...